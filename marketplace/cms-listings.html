<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Marketplace - CMS Integrated | Ardonie Capital</title>
    <meta name="description" content="Browse and discover profitable business opportunities with our comprehensive marketplace featuring real-time updates, advanced filtering, and secure messaging.">
    
    <!-- Tailwind CSS -->
    <link rel="stylesheet" href="../assets/css/tailwind.css">
    
    <!-- Navigation Styles -->
    <link rel="stylesheet" href="../components/navigation-styles.css">
    <link rel="stylesheet" href="../assets/css/admin-navigation.css">
    
    <!-- Enhanced Marketplace Styles -->
    <style>
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        #business-details-modal {
            backdrop-filter: blur(4px);
        }
        
        .modal-content {
            animation: modalSlideIn 0.3s ease-out;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: scale(0.95) translateY(-10px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        .favorite-heart {
            transition: all 0.2s ease;
        }
        
        .favorite-heart:hover {
            transform: scale(1.1);
        }
        
        .listing-card {
            transition: all 0.3s ease;
        }
        
        .listing-card:hover {
            transform: translateY(-2px);
        }
        
        .filter-sidebar {
            max-height: calc(100vh - 120px);
            overflow-y: auto;
        }

        /* Enhanced Filter Sidebar Styles */
        .filter-sidebar-container {
            transition: all 0.3s ease-in-out;
        }

        .filter-sidebar-mobile {
            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
        }

        .filter-sidebar-mobile.open {
            transform: translateX(0);
        }

        .filter-overlay {
            background: rgba(0, 0, 0, 0.5);
            -webkit-backdrop-filter: blur(4px);
            backdrop-filter: blur(4px);
            transition: opacity 0.3s ease-in-out;
        }

        .filter-toggle-btn {
            transition: all 0.2s ease;
        }

        .filter-toggle-btn:hover {
            transform: scale(1.05);
        }

        .filter-section {
            border-bottom: 1px solid rgb(226 232 240);
        }

        .dark .filter-section {
            border-bottom-color: rgb(51 65 85);
        }

        @media (max-width: 1023px) {
            .filter-sidebar-desktop {
                display: none;
            }
        }

        @media (min-width: 1024px) {
            .filter-sidebar-mobile {
                display: none;
            }

            .filter-toggle-mobile {
                display: none;
            }
        }
    </style>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            light: '#3B82F6',
                            DEFAULT: '#2563EB',
                            dark: '#1D4ED8'
                        },
                        accent: '#10B981'
                    }
                }
            }
        };
    </script>
</head>
<body class="bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-white">
    <!-- Navigation Component -->
    <div id="main-navigation-container"></div>

    <!-- Admin Navigation (if applicable) -->
    <div id="admin-navigation-container"></div>

    <!-- Main Content -->
    <main class="pt-16">
        <!-- Header Section -->
        <div class="bg-gradient-to-r from-blue-600 to-emerald-600 text-white py-12">
            <div class="container mx-auto px-4">
                <div class="max-w-4xl mx-auto text-center">
                    <h1 class="text-4xl md:text-5xl font-bold mb-4">Business Marketplace</h1>
                    <p class="text-xl text-blue-100 mb-6">Discover profitable business opportunities with real-time updates and advanced filtering</p>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center">
                        <div class="bg-white/20 backdrop-blur-sm rounded-lg px-6 py-3">
                            <div class="text-2xl font-bold">500+</div>
                            <div class="text-sm text-blue-100">Active Listings</div>
                        </div>
                        <div class="bg-white/20 backdrop-blur-sm rounded-lg px-6 py-3">
                            <div class="text-2xl font-bold">$2.5M</div>
                            <div class="text-sm text-blue-100">Avg. Revenue</div>
                        </div>
                        <div class="bg-white/20 backdrop-blur-sm rounded-lg px-6 py-3">
                            <div class="text-2xl font-bold">24%</div>
                            <div class="text-sm text-blue-100">Avg. ROI</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Marketplace Content -->
        <div class="container mx-auto px-4 py-8">
            <!-- Mobile Filter Toggle -->
            <div class="lg:hidden mb-6 filter-toggle-mobile">
                <button type="button" id="mobile-filter-toggle" class="filter-toggle-btn flex items-center space-x-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg px-4 py-3 shadow-sm hover:shadow-md">
                    <svg class="w-5 h-5 text-slate-600 dark:text-slate-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
                    </svg>
                    <span class="font-medium text-slate-700 dark:text-slate-300">Filters</span>
                    <span id="filter-count" class="bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-xs font-medium px-2 py-1 rounded-full hidden">0</span>
                </button>
            </div>

            <div class="flex flex-col lg:flex-row gap-8">
                <!-- Desktop Filters Sidebar -->
                <div class="lg:w-1/3 xl:w-1/4 filter-sidebar-desktop">
                    <div class="bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden filter-sidebar">
                        <div class="bg-gradient-to-r from-blue-50 to-emerald-50 dark:from-slate-700 dark:to-slate-600 px-6 py-4 border-b border-slate-200 dark:border-slate-600">
                            <h2 class="text-xl font-bold text-slate-900 dark:text-white flex items-center">
                                <svg class="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
                                </svg>
                                Filters
                            </h2>
                        </div>
                        <div class="p-6 space-y-6">

                            <!-- Search -->
                            <div class="filter-section pb-6">
                                <label for="search-input" class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3">
                                    üîç Search Businesses
                                </label>
                                <div class="relative">
                                    <input type="text" id="search-input" placeholder="Search by name, type, location..." class="w-full pl-10 pr-4 py-3 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors">
                                    <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                    </svg>
                                </div>
                            </div>

                            <!-- Express Sellers Toggle -->
                            <div class="filter-section pb-6">
                                <div class="bg-gradient-to-r from-emerald-50 to-blue-50 dark:from-emerald-900/20 dark:to-blue-900/20 rounded-lg p-4 border border-emerald-200 dark:border-emerald-700">
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" id="express-only" class="w-4 h-4 text-emerald-600 bg-white border-emerald-300 rounded focus:ring-emerald-500 focus:ring-2 dark:bg-slate-700 dark:border-emerald-600">
                                        <div class="ml-3">
                                            <span class="text-sm font-semibold text-slate-700 dark:text-slate-300">üöñ Express Sellers Only</span>
                                            <p class="text-xs text-slate-500 dark:text-slate-400 mt-1">Expedited sale process with faster closing</p>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <!-- Business Type -->
                            <div class="filter-section pb-6">
                                <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-4">
                                    üè¢ Business Type
                                </label>
                                <div class="space-y-3">
                                    <label class="flex items-center p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 cursor-pointer transition-colors">
                                        <input type="checkbox" name="business-type" value="Full Service Auto Repair" class="w-4 h-4 text-blue-600 bg-white border-slate-300 rounded focus:ring-blue-500 focus:ring-2 dark:bg-slate-700 dark:border-slate-600">
                                        <span class="ml-3 text-sm font-medium text-slate-700 dark:text-slate-300">üîß Full Service Auto Repair</span>
                                    </label>
                                    <label class="flex items-center p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 cursor-pointer transition-colors">
                                        <input type="checkbox" name="business-type" value="Transmission Repair" class="w-4 h-4 text-blue-600 bg-white border-slate-300 rounded focus:ring-blue-500 focus:ring-2 dark:bg-slate-700 dark:border-slate-600">
                                        <span class="ml-3 text-sm font-medium text-slate-700 dark:text-slate-300">‚öôÔ∏è Transmission Repair</span>
                                    </label>
                                    <label class="flex items-center p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 cursor-pointer transition-colors">
                                        <input type="checkbox" name="business-type" value="Quick Service" class="w-4 h-4 text-blue-600 bg-white border-slate-300 rounded focus:ring-blue-500 focus:ring-2 dark:bg-slate-700 dark:border-slate-600">
                                        <span class="ml-3 text-sm font-medium text-slate-700 dark:text-slate-300">‚ö° Quick Service</span>
                                    </label>
                                    <label class="flex items-center p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 cursor-pointer transition-colors">
                                        <input type="checkbox" name="business-type" value="Collision Repair" class="w-4 h-4 text-blue-600 bg-white border-slate-300 rounded focus:ring-blue-500 focus:ring-2 dark:bg-slate-700 dark:border-slate-600">
                                        <span class="ml-3 text-sm font-medium text-slate-700 dark:text-slate-300">üöó Collision Repair</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Price Range -->
                            <div class="filter-section pb-6">
                                <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-4">
                                    üí∞ Price Range
                                </label>
                                <div class="grid grid-cols-2 gap-3 mb-4">
                                    <div>
                                        <label for="price-min" class="block text-xs font-medium text-slate-500 dark:text-slate-400 mb-2">Min Price</label>
                                        <input type="number" id="price-min" placeholder="0" min="0" step="1000" class="w-full px-3 py-3 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors">
                                    </div>
                                    <div>
                                        <label for="price-max" class="block text-xs font-medium text-slate-500 dark:text-slate-400 mb-2">Max Price</label>
                                        <input type="number" id="price-max" placeholder="‚àû" min="0" step="1000" class="w-full px-3 py-3 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors">
                                    </div>
                                </div>
                                <div class="flex flex-wrap gap-2">
                                    <button type="button" onclick="document.getElementById('price-min').value=''; document.getElementById('price-max').value='500000'; window.cmsMarketplace?.loadListings()" class="px-3 py-2 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-xs font-medium rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/50 transition-colors">Under $500K</button>
                                    <button type="button" onclick="document.getElementById('price-min').value='500000'; document.getElementById('price-max').value='1000000'; window.cmsMarketplace?.loadListings()" class="px-3 py-2 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-xs font-medium rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/50 transition-colors">$500K-$1M</button>
                                    <button type="button" onclick="document.getElementById('price-min').value='1000000'; document.getElementById('price-max').value=''; window.cmsMarketplace?.loadListings()" class="px-3 py-2 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-xs font-medium rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/50 transition-colors">Over $1M</button>
                                </div>
                            </div>

                            <!-- Location -->
                            <div class="filter-section pb-6">
                                <label for="location-filter" class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3">
                                    üìç Location
                                </label>
                                <div class="relative">
                                    <select id="location-filter" class="w-full pl-10 pr-4 py-3 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 appearance-none transition-colors">
                                        <option value="all">All DFW Area</option>
                                        <option value="Dallas">Dallas</option>
                                        <option value="Fort Worth">Fort Worth</option>
                                        <option value="Plano">Plano</option>
                                        <option value="Arlington">Arlington</option>
                                        <option value="Irving">Irving</option>
                                        <option value="Garland">Garland</option>
                                        <option value="Frisco">Frisco</option>
                                        <option value="McKinney">McKinney</option>
                                    </select>
                                    <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    </svg>
                                    <svg class="absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                    </svg>
                                </div>
                            </div>

                            <!-- Clear Filters -->
                            <div class="pt-4">
                                <button type="button" onclick="window.cmsMarketplace?.clearFilters()" class="w-full bg-gradient-to-r from-red-50 to-orange-50 dark:from-red-900/20 dark:to-orange-900/20 hover:from-red-100 hover:to-orange-100 dark:hover:from-red-900/30 dark:hover:to-orange-900/30 text-red-700 dark:text-red-300 font-semibold py-3 px-4 rounded-lg border border-red-200 dark:border-red-700 transition-all duration-200 flex items-center justify-center">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                    </svg>
                                    Clear All Filters
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mobile Filter Sidebar -->
                <div id="mobile-filter-sidebar" class="filter-sidebar-mobile fixed inset-y-0 left-0 z-50 w-80 bg-white dark:bg-slate-800 shadow-2xl lg:hidden">
                    <div class="flex items-center justify-between p-6 border-b border-slate-200 dark:border-slate-700">
                        <h2 class="text-xl font-bold text-slate-900 dark:text-white flex items-center">
                            <svg class="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
                            </svg>
                            Filters
                        </h2>
                        <button type="button" id="close-mobile-filter" class="text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    <div class="p-6 space-y-6 overflow-y-auto h-full pb-20">
                        <!-- Mobile filters content (same as desktop) -->
                        <div id="mobile-filters-content">
                            <!-- Content will be duplicated from desktop filters -->
                        </div>
                    </div>
                </div>

                <!-- Mobile Filter Overlay -->
                <div id="mobile-filter-overlay" class="filter-overlay fixed inset-0 z-40 hidden lg:hidden"></div>
                    </div>
                </div>

                <!-- Main Content Area -->
                <div class="flex-1 lg:w-2/3 xl:w-3/4">
                    <!-- Results Header -->
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                        <div>
                            <h2 class="text-2xl font-bold text-slate-900 dark:text-white mb-2">Available Businesses</h2>
                            <p id="results-count" class="text-slate-600 dark:text-slate-300">Loading listings...</p>
                        </div>
                        <div class="flex items-center gap-4">
                            <select id="sort-select" name="sort" aria-label="Sort listings" class="px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary">
                                <option value="newest">Sort by: Newest</option>
                                <option value="oldest">Oldest First</option>
                                <option value="price-low">Price: Low to High</option>
                                <option value="price-high">Price: High to Low</option>
                                <option value="revenue-high">Revenue: High to Low</option>
                                <option value="revenue-low">Revenue: Low to High</option>
                            </select>
                        </div>
                    </div>

                    <!-- Listings Grid -->
                    <div id="listings-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Dynamic listings will be loaded here -->
                        <div class="col-span-full text-center py-12">
                            <div class="animate-spin w-8 h-8 border-2 border-primary border-t-transparent rounded-full mx-auto mb-4"></div>
                            <p class="text-slate-600 dark:text-slate-300">Initializing CMS marketplace...</p>
                        </div>
                    </div>

                    <!-- Pagination (placeholder for future implementation) -->
                    <div class="mt-8 flex justify-center">
                        <nav class="flex items-center space-x-2">
                            <button class="px-3 py-2 text-sm text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200">Previous</button>
                            <button class="px-3 py-2 text-sm bg-primary text-white rounded">1</button>
                            <button class="px-3 py-2 text-sm text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200">2</button>
                            <button class="px-3 py-2 text-sm text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200">3</button>
                            <button class="px-3 py-2 text-sm text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200">Next</button>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Business Details Modal -->
    <div id="business-details-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 items-center justify-center p-4 hidden">
        <div class="modal-content bg-white dark:bg-slate-800 rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-hidden">
            <!-- Modal Header -->
            <div class="flex items-center justify-between p-6 border-b border-slate-200 dark:border-slate-700">
                <div class="flex items-center">
                    <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-emerald-600 rounded-lg flex items-center justify-center mr-4">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                        </svg>
                    </div>
                    <div>
                        <h2 id="modal-business-name" class="text-2xl font-bold text-slate-900 dark:text-white">Business Name</h2>
                        <p id="modal-business-location" class="text-slate-600 dark:text-slate-300 mt-1">Location</p>
                    </div>
                </div>
                <button type="button" onclick="window.cmsMarketplace?.closeDetailsModal()" aria-label="Close business details modal" class="text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <!-- Modal Content -->
            <div class="flex flex-col lg:flex-row max-h-[calc(90vh-80px)]">
                <!-- Left Side - Images and Gallery -->
                <div class="lg:w-1/2 bg-slate-50 dark:bg-slate-700">
                    <div class="relative h-64 lg:h-full">
                        <img id="modal-main-image" src="" alt="Business Image" class="w-full h-full object-cover">
                        <div class="absolute top-4 right-4 flex gap-2">
                            <div id="modal-badges-container" class="flex flex-wrap gap-2">
                                <!-- Dynamic badges will be inserted here -->
                            </div>
                        </div>
                        <button type="button" id="modal-favorite-btn" aria-label="Add to favorites" title="Add to favorites" class="absolute top-4 left-4 p-3 bg-white/90 dark:bg-slate-800/90 rounded-full hover:bg-white dark:hover:bg-slate-800 transition-all shadow-lg">
                            <svg class="w-5 h-5 text-slate-600 dark:text-slate-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Right Side - Business Information -->
                <div class="lg:w-1/2 overflow-y-auto">
                    <div class="p-6 space-y-6">
                        <!-- Key Metrics -->
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-slate-50 dark:bg-slate-700 rounded-lg p-4">
                                <div class="text-sm text-slate-600 dark:text-slate-400">Asking Price</div>
                                <div id="modal-asking-price" class="text-2xl font-bold text-slate-900 dark:text-white">$0</div>
                            </div>
                            <div class="bg-slate-50 dark:bg-slate-700 rounded-lg p-4">
                                <div class="text-sm text-slate-600 dark:text-slate-400">Annual Revenue</div>
                                <div id="modal-revenue" class="text-2xl font-bold text-slate-900 dark:text-white">$0</div>
                            </div>
                            <div class="bg-slate-50 dark:bg-slate-700 rounded-lg p-4">
                                <div class="text-sm text-slate-600 dark:text-slate-400">Cash Flow</div>
                                <div id="modal-cash-flow" class="text-2xl font-bold text-emerald-600">$0</div>
                            </div>
                            <div class="bg-slate-50 dark:bg-slate-700 rounded-lg p-4">
                                <div class="text-sm text-slate-600 dark:text-slate-400">ROI</div>
                                <div id="modal-roi" class="text-2xl font-bold text-blue-600">0%</div>
                            </div>
                        </div>

                        <!-- Business Description -->
                        <div>
                            <h3 class="text-lg font-semibold text-slate-900 dark:text-white mb-3">About This Business</h3>
                            <p id="modal-description" class="text-slate-600 dark:text-slate-300 leading-relaxed">Business description will appear here...</p>
                        </div>

                        <!-- Business Details -->
                        <div>
                            <h3 class="text-lg font-semibold text-slate-900 dark:text-white mb-3">Business Details</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="flex justify-between py-2 border-b border-slate-200 dark:border-slate-600">
                                    <span class="text-slate-600 dark:text-slate-400">Business Type</span>
                                    <span id="modal-business-type" class="font-medium text-slate-900 dark:text-white">-</span>
                                </div>
                                <div class="flex justify-between py-2 border-b border-slate-200 dark:border-slate-600">
                                    <span class="text-slate-600 dark:text-slate-400">Established</span>
                                    <span id="modal-established" class="font-medium text-slate-900 dark:text-white">-</span>
                                </div>
                                <div class="flex justify-between py-2 border-b border-slate-200 dark:border-slate-600">
                                    <span class="text-slate-600 dark:text-slate-400">Employees</span>
                                    <span id="modal-employees" class="font-medium text-slate-900 dark:text-white">-</span>
                                </div>
                                <div class="flex justify-between py-2 border-b border-slate-200 dark:border-slate-600">
                                    <span class="text-slate-600 dark:text-slate-400">Square Footage</span>
                                    <span id="modal-square-footage" class="font-medium text-slate-900 dark:text-white">-</span>
                                </div>
                            </div>
                        </div>

                        <!-- Key Features -->
                        <div>
                            <h3 class="text-lg font-semibold text-slate-900 dark:text-white mb-3">Key Features</h3>
                            <div id="modal-features-container" class="flex flex-wrap gap-2">
                                <!-- Dynamic features will be inserted here -->
                            </div>
                        </div>

                        <!-- Contact Information -->
                        <div>
                            <h3 class="text-lg font-semibold text-slate-900 dark:text-white mb-3">Seller Information</h3>
                            <div class="bg-slate-50 dark:bg-slate-700 rounded-lg p-4">
                                <div class="flex items-center mb-3">
                                    <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-emerald-600 rounded-full flex items-center justify-center mr-3">
                                        <span id="modal-seller-initials" class="text-white font-semibold">--</span>
                                    </div>
                                    <div>
                                        <div id="modal-seller-name" class="font-semibold text-slate-900 dark:text-white">Seller Name</div>
                                        <div id="modal-seller-company" class="text-sm text-slate-600 dark:text-slate-400">Company</div>
                                    </div>
                                </div>
                                <div class="flex gap-3">
                                    <button type="button" id="modal-contact-btn" onclick="window.cmsMarketplace?.contactSeller(this.dataset.listingId)" class="flex-1 bg-gradient-to-r from-blue-500 to-emerald-600 hover:from-blue-600 hover:to-emerald-700 text-white py-3 px-6 rounded-lg font-semibold transition-all duration-300">
                                        Contact Seller
                                    </button>
                                    <button type="button" id="modal-schedule-btn" onclick="window.cmsMarketplace?.scheduleTour(this.dataset.listingId)" class="flex-1 border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 py-3 px-6 rounded-lg font-semibold transition-colors">
                                        Schedule Tour
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Load Navigation Component -->
    <script src="../components/main-navigation.js"></script>

    <!-- Load Admin Navigation Component -->
    <script src="../components/admin-navigation.js"></script>

    <!-- Load CMS Marketplace System -->
    <script src="cms-marketplace.js"></script>

    <!-- Enhanced Event Listeners -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Modal close event listeners
            const modal = document.getElementById('business-details-modal');
            if (modal) {
                // Close on background click
                modal.addEventListener('click', (e) => {
                    if (e.target === modal && window.cmsMarketplace) {
                        window.cmsMarketplace.closeDetailsModal();
                    }
                });

                // Close on escape key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && !modal.classList.contains('hidden') && window.cmsMarketplace) {
                        window.cmsMarketplace.closeDetailsModal();
                    }
                });
            }

            // Modal favorite button event listener
            const modalFavoriteBtn = document.getElementById('modal-favorite-btn');
            if (modalFavoriteBtn) {
                modalFavoriteBtn.addEventListener('click', () => {
                    const listingId = modalFavoriteBtn.dataset.listingId;
                    if (listingId && window.cmsMarketplace) {
                        window.cmsMarketplace.toggleFavorite(listingId);
                    }
                });
            }

            // Mobile filter sidebar functionality
            const mobileFilterToggle = document.getElementById('mobile-filter-toggle');
            const mobileFilterSidebar = document.getElementById('mobile-filter-sidebar');
            const mobileFilterOverlay = document.getElementById('mobile-filter-overlay');
            const closeMobileFilter = document.getElementById('close-mobile-filter');
            const mobileFiltersContent = document.getElementById('mobile-filters-content');
            const desktopFilters = document.querySelector('.filter-sidebar-desktop .space-y-6');

            // Copy desktop filters to mobile
            if (desktopFilters && mobileFiltersContent) {
                mobileFiltersContent.innerHTML = desktopFilters.innerHTML;
            }

            function openMobileFilters() {
                mobileFilterSidebar.classList.add('open');
                mobileFilterOverlay.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            }

            function closeMobileFilters() {
                mobileFilterSidebar.classList.remove('open');
                mobileFilterOverlay.classList.add('hidden');
                document.body.style.overflow = '';
            }

            // Event listeners for mobile filter
            if (mobileFilterToggle) {
                mobileFilterToggle.addEventListener('click', openMobileFilters);
            }

            if (closeMobileFilter) {
                closeMobileFilter.addEventListener('click', closeMobileFilters);
            }

            if (mobileFilterOverlay) {
                mobileFilterOverlay.addEventListener('click', closeMobileFilters);
            }

            // Close mobile filters on escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && mobileFilterSidebar.classList.contains('open')) {
                    closeMobileFilters();
                }
            });

            // Update filter count badge
            function updateFilterCount() {
                const filterCount = document.getElementById('filter-count');
                if (!filterCount) return;

                let activeFilters = 0;

                // Check search input
                const searchInput = document.getElementById('search-input');
                if (searchInput && searchInput.value.trim()) activeFilters++;

                // Check express toggle
                const expressToggle = document.getElementById('express-only');
                if (expressToggle && expressToggle.checked) activeFilters++;

                // Check business type checkboxes
                const businessTypeCheckboxes = document.querySelectorAll('input[name="business-type"]:checked');
                activeFilters += businessTypeCheckboxes.length;

                // Check price inputs
                const priceMin = document.getElementById('price-min');
                const priceMax = document.getElementById('price-max');
                if (priceMin && priceMin.value) activeFilters++;
                if (priceMax && priceMax.value) activeFilters++;

                // Check location filter
                const locationFilter = document.getElementById('location-filter');
                if (locationFilter && locationFilter.value !== 'all') activeFilters++;

                // Update badge
                if (activeFilters > 0) {
                    filterCount.textContent = activeFilters;
                    filterCount.classList.remove('hidden');
                } else {
                    filterCount.classList.add('hidden');
                }
            }

            // Add event listeners to update filter count
            const filterInputs = [
                'search-input',
                'express-only',
                'price-min',
                'price-max',
                'location-filter'
            ];

            filterInputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', updateFilterCount);
                    element.addEventListener('change', updateFilterCount);
                }
            });

            // Add event listeners for business type checkboxes
            document.addEventListener('change', (e) => {
                if (e.target.name === 'business-type') {
                    updateFilterCount();
                }
            });

            // Initial filter count update
            setTimeout(updateFilterCount, 500);
        });
    </script>
</body>
</html>
