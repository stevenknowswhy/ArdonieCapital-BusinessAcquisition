<!-- Featured Listings Section Component -->
<section id="featured-listings-section" class="py-20 bg-slate-50 dark:bg-slate-800">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
            <h2 class="text-3xl md:text-4xl font-bold text-slate-900 dark:text-white mb-6">Featured Auto Repair Shops</h2>
            <p class="text-xl text-slate-700 dark:text-slate-300 max-w-3xl mx-auto">
                Discover premium auto repair businesses available for acquisition in the Dallas-Fort Worth area. Each listing is verified and ready for serious buyers.
            </p>
        </div>

        <!-- Featured Listings Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
            <!-- Listing 1: Premium Auto Service -->
            <div class="bg-white dark:bg-slate-900 rounded-2xl p-6 shadow-xl hover:shadow-2xl transition-all duration-500 transform hover:-translate-y-2 group relative overflow-hidden border border-slate-200 dark:border-slate-700">
                <!-- Urgency Badge -->
                <div class="absolute top-4 right-4 bg-orange-500 text-white text-xs font-bold px-3 py-1 rounded-full z-10">
                    Express Deal
                </div>

                <!-- Listing Image -->
                <div class="relative z-0">
                    <img src="https://images.unsplash.com/photo-1558618666-fcd25c85cd64?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80" alt="Premium Auto Service Center - Plano, TX" class="w-full h-48 object-cover rounded-xl mb-6" loading="lazy">
                    <div class="absolute inset-0 bg-black/20 rounded-xl"></div>
                    <div class="absolute bottom-4 left-4 text-white z-10">
                        <div class="text-sm font-medium">Premium Auto Service</div>
                        <div class="text-xs opacity-90">Plano, TX</div>
                    </div>
                </div>

                <!-- Listing Details -->
                <div class="space-y-4 relative z-10">
                    <div class="flex justify-between items-start">
                        <h3 class="text-xl font-bold text-slate-800 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">
                            Premium Auto Service Center
                        </h3>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-emerald-600 dark:text-emerald-400">$485K</div>
                            <div class="text-sm text-slate-600 dark:text-slate-400">Asking Price</div>
                        </div>
                    </div>

                    <!-- Key Metrics -->
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div class="bg-slate-100 dark:bg-slate-800 rounded-lg p-3">
                            <div class="text-slate-700 dark:text-slate-400">Annual Revenue</div>
                            <div class="font-bold text-slate-800 dark:text-white">$750K</div>
                        </div>
                        <div class="bg-slate-100 dark:bg-slate-800 rounded-lg p-3">
                            <div class="text-slate-700 dark:text-slate-400">Established</div>
                            <div class="font-bold text-slate-800 dark:text-white">2015</div>
                        </div>
                    </div>

                    <!-- Features -->
                    <div class="space-y-2">
                        <div class="flex items-center text-sm text-slate-700 dark:text-slate-300">
                            <svg class="w-4 h-4 text-emerald-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            8-bay service facility
                        </div>
                        <div class="flex items-center text-sm text-slate-700 dark:text-slate-300">
                            <svg class="w-4 h-4 text-emerald-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            Loyal customer base (500+ active)
                        </div>
                        <div class="flex items-center text-sm text-slate-700 dark:text-slate-300">
                            <svg class="w-4 h-4 text-emerald-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            Prime Plano location
                        </div>
                    </div>

                    <!-- CTA Button -->
                    <button type="button" id="view-details-premium-auto" class="featured-listing-button btn-blue w-full text-white font-semibold py-3 px-6 rounded-full shadow-lg focus:outline-none focus:ring-4 focus:ring-blue-300 dark:focus:ring-blue-800" onclick="handleBusinessDetailsClick('premium-auto-service')" aria-label="View details for Premium Auto Service Center">
                        View Details →
                    </button>
                </div>
            </div>

            <!-- Listing 2: Family Auto Repair -->
            <div class="bg-white dark:bg-slate-900 rounded-2xl p-6 shadow-xl hover:shadow-2xl transition-all duration-500 transform hover:-translate-y-2 group relative overflow-hidden border border-slate-200 dark:border-slate-700">
                <!-- Verified Badge -->
                <div class="absolute top-4 right-4 bg-emerald-500 text-white text-xs font-bold px-3 py-1 rounded-full z-10">
                    Verified
                </div>

                <!-- Listing Image -->
                <div class="relative z-0">
                    <img src="https://images.unsplash.com/photo-1486754735734-325b5831c3ad?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80" alt="Family Auto Repair Shop - Frisco, TX" class="w-full h-48 object-cover rounded-xl mb-6" loading="lazy">
                    <div class="absolute inset-0 bg-black/20 rounded-xl"></div>
                    <div class="absolute bottom-4 left-4 text-white z-10">
                        <div class="text-sm font-medium">Family Auto Repair</div>
                        <div class="text-xs opacity-90">Frisco, TX</div>
                    </div>
                </div>

                <!-- Listing Details -->
                <div class="space-y-4 relative z-10">
                    <div class="flex justify-between items-start">
                        <h3 class="text-xl font-bold text-slate-800 dark:text-white group-hover:text-emerald-600 dark:group-hover:text-emerald-400 transition-colors">
                            Family Auto Repair Shop
                        </h3>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-emerald-600 dark:text-emerald-400">$325K</div>
                            <div class="text-sm text-slate-600 dark:text-slate-400">Asking Price</div>
                        </div>
                    </div>

                    <!-- Key Metrics -->
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div class="bg-slate-100 dark:bg-slate-800 rounded-lg p-3">
                            <div class="text-slate-700 dark:text-slate-400">Annual Revenue</div>
                            <div class="font-bold text-slate-800 dark:text-white">$520K</div>
                        </div>
                        <div class="bg-slate-100 dark:bg-slate-800 rounded-lg p-3">
                            <div class="text-slate-700 dark:text-slate-400">Established</div>
                            <div class="font-bold text-slate-800 dark:text-white">2008</div>
                        </div>
                    </div>

                    <!-- Features -->
                    <div class="space-y-2">
                        <div class="flex items-center text-sm text-slate-700 dark:text-slate-300">
                            <svg class="w-4 h-4 text-emerald-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            6-bay service center
                        </div>
                        <div class="flex items-center text-sm text-slate-700 dark:text-slate-300">
                            <svg class="w-4 h-4 text-emerald-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            Established clientele
                        </div>
                        <div class="flex items-center text-sm text-slate-700 dark:text-slate-300">
                            <svg class="w-4 h-4 text-emerald-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            Growing Frisco market
                        </div>
                    </div>

                    <!-- CTA Button -->
                    <button type="button" id="view-details-family-auto" class="featured-listing-button btn-emerald w-full text-white font-semibold py-3 px-6 rounded-full shadow-lg focus:outline-none focus:ring-4 focus:ring-emerald-300 dark:focus:ring-emerald-800" onclick="handleBusinessDetailsClick('family-auto-repair')" aria-label="View details for Family Auto Repair Shop">
                        View Details →
                    </button>
                </div>
            </div>

            <!-- Listing 3: Express Auto Care -->
            <div class="bg-white dark:bg-slate-900 rounded-2xl p-6 shadow-xl hover:shadow-2xl transition-all duration-500 transform hover:-translate-y-2 group relative overflow-hidden border border-slate-200 dark:border-slate-700">
                <!-- New Badge -->
                <div class="absolute top-4 right-4 bg-purple-500 text-white text-xs font-bold px-3 py-1 rounded-full z-10">
                    New Listing
                </div>

                <!-- Listing Image -->
                <div class="relative z-0">
                    <img src="https://images.unsplash.com/photo-1619642751034-765dfdf7c58e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1374&q=80" alt="Express Auto Care Center - Allen, TX" class="w-full h-48 object-cover rounded-xl mb-6" loading="lazy">
                    <div class="absolute inset-0 bg-black/20 rounded-xl"></div>
                    <div class="absolute bottom-4 left-4 text-white z-10">
                        <div class="text-sm font-medium">Express Auto Care</div>
                        <div class="text-xs opacity-90">Allen, TX</div>
                    </div>
                </div>

                <!-- Listing Details -->
                <div class="space-y-4 relative z-10">
                    <div class="flex justify-between items-start">
                        <h3 class="text-xl font-bold text-slate-800 dark:text-white group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors">
                            Express Auto Care Center
                        </h3>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-emerald-600 dark:text-emerald-400">$275K</div>
                            <div class="text-sm text-slate-600 dark:text-slate-400">Asking Price</div>
                        </div>
                    </div>

                    <!-- Key Metrics -->
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div class="bg-slate-100 dark:bg-slate-800 rounded-lg p-3">
                            <div class="text-slate-700 dark:text-slate-400">Annual Revenue</div>
                            <div class="font-bold text-slate-800 dark:text-white">$420K</div>
                        </div>
                        <div class="bg-slate-100 dark:bg-slate-800 rounded-lg p-3">
                            <div class="text-slate-700 dark:text-slate-400">Established</div>
                            <div class="font-bold text-slate-800 dark:text-white">2012</div>
                        </div>
                    </div>

                    <!-- Features -->
                    <div class="space-y-2">
                        <div class="flex items-center text-sm text-slate-700 dark:text-slate-300">
                            <svg class="w-4 h-4 text-emerald-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            Quick service focus
                        </div>
                        <div class="flex items-center text-sm text-slate-700 dark:text-slate-300">
                            <svg class="w-4 h-4 text-emerald-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            Modern equipment
                        </div>
                        <div class="flex items-center text-sm text-slate-700 dark:text-slate-300">
                            <svg class="w-4 h-4 text-emerald-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            High-traffic location
                        </div>
                    </div>

                    <!-- CTA Button -->
                    <button type="button" id="view-details-express-auto" class="featured-listing-button btn-purple w-full text-white font-semibold py-3 px-6 rounded-full shadow-lg focus:outline-none focus:ring-4 focus:ring-purple-300 dark:focus:ring-purple-800" onclick="handleBusinessDetailsClick('express-auto-care')" aria-label="View details for Express Auto Care Center">
                        View Details →
                    </button>
                </div>
            </div>
        </div>

        <!-- View All Listings CTA -->
        <div class="text-center">
            <div class="bg-gradient-to-r from-blue-50 to-purple-50 dark:from-slate-800 dark:to-slate-700 rounded-2xl p-8 max-w-4xl mx-auto border border-blue-200 dark:border-slate-600">
                <h3 class="text-2xl font-bold text-slate-900 dark:text-white mb-4">Ready to Find Your Perfect Auto Shop?</h3>
                <p class="text-slate-700 dark:text-slate-300 mb-6 max-w-2xl mx-auto">
                    Browse our complete database of verified auto repair businesses for sale in the DFW area. Get instant access to financial details, photos, and seller contact information.
                </p>

                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <a href="/listings.html" class="inline-flex items-center px-8 py-4 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold rounded-full transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-1">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                        Browse All Listings
                    </a>
                    <a href="/contact.html" class="inline-flex items-center px-8 py-4 border-2 border-slate-400 dark:border-slate-600 text-slate-800 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 font-semibold rounded-full transition-all duration-200 hover:border-blue-500 dark:hover:border-blue-500 hover:text-blue-700 dark:hover:text-blue-400">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                        </svg>
                        Get Personal Assistance
                    </a>
                </div>

                <!-- Trust Indicator -->
                <p class="text-xs text-slate-600 dark:text-slate-400 mt-4">
                    ✓ All listings verified • ✓ Financial records reviewed • ✓ Direct seller contact
                </p>
            </div>
        </div>
    </div>

    <!-- Business Details Modal -->
    <div id="business-details-modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm" role="dialog" aria-labelledby="modal-title" aria-modal="true">
        <div class="relative w-full max-w-4xl mx-4 bg-white dark:bg-slate-900 rounded-2xl shadow-2xl max-h-[90vh] overflow-y-auto">
            <!-- Modal Header -->
            <div class="sticky top-0 bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-700 px-6 py-4 rounded-t-2xl">
                <div class="flex items-center justify-between">
                    <h2 id="modal-title" class="text-2xl font-bold text-slate-900 dark:text-white">Business Details</h2>
                    <button type="button" id="close-modal" class="p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors" aria-label="Close modal">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Modal Content -->
            <div id="modal-content" class="p-6">
                <!-- Content will be dynamically populated -->
            </div>
        </div>
    </div>

    <!-- Featured Listings Styles -->
    <style>
        /* Enhanced light mode contrast */
        .featured-listing-card {
            position: relative;
            z-index: 1;
        }

        .featured-listing-card .listing-content {
            position: relative;
            z-index: 10;
        }

        /* Ensure proper text contrast in light mode */
        .light-mode-text {
            color: #1e293b !important; /* slate-800 */
        }

        .light-mode-secondary {
            color: #475569 !important; /* slate-600 */
        }

        .light-mode-muted {
            color: #64748b !important; /* slate-500 */
        }

        /* Enhanced button styling for consistency */
        .featured-listing-button {
            background: linear-gradient(to right, var(--gradient-from), var(--gradient-to)) !important;
            transition: all 0.3s ease !important;
            transform: translateY(0) !important;
        }

        .featured-listing-button:hover {
            background: linear-gradient(to right, var(--gradient-hover-from), var(--gradient-hover-to)) !important;
            transform: translateY(-2px) scale(1.05) !important;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04) !important;
        }

        .featured-listing-button:focus {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
        }

        /* Specific button color variables */
        .btn-blue {
            --gradient-from: #3b82f6;
            --gradient-to: #2563eb;
            --gradient-hover-from: #2563eb;
            --gradient-hover-to: #1d4ed8;
        }

        .btn-emerald {
            --gradient-from: #10b981;
            --gradient-to: #059669;
            --gradient-hover-from: #059669;
            --gradient-hover-to: #047857;
        }

        .btn-purple {
            --gradient-from: #8b5cf6;
            --gradient-to: #7c3aed;
            --gradient-hover-from: #7c3aed;
            --gradient-hover-to: #6d28d9;
        }

        /* Modal z-index fix */
        #business-details-modal {
            z-index: 9999 !important;
        }

        /* Ensure badges are visible */
        .listing-badge {
            z-index: 20 !important;
            position: relative;
        }
    </style>

    <!-- Featured Listings JavaScript -->
    <script>
        // Open business details modal (restored functionality)
        window.handleBusinessDetailsClick = function(businessId) {
            console.log('Opening modal for business:', businessId);
            try {
                if (typeof window.openBusinessDetailsModal === 'function') {
                    window.openBusinessDetailsModal(businessId);
                } else {
                    console.error('openBusinessDetailsModal not yet loaded');
                    alert('Please wait a moment and try again.');
                }
            } catch (error) {
                console.error('Error opening modal:', error);
                alert('Sorry, there was an error loading the business details. Please try again.');
            }
        };

        // Debug logging
        console.log('Featured Listings JavaScript loading...');

        // Comprehensive business data for featured listings
        const featuredBusinesses = {
            'premium-auto-service': {
                // Basic Information
                displayName: 'Established Auto Repair Shop',
                location: 'Plano, TX',
                businessType: 'Auto Repair & Service',
                businessStructure: 'LLC',
                yearEstablished: 2015,
                employees: 8,

                // Financial Information
                askingPrice: '$485,000',
                annualRevenue: '$750,000',
                netProfit: '$185,000',
                grossMargin: '65%',

                // Business Overview
                description: 'Premium full-service auto repair facility in prime Plano location. Established customer base with 500+ active clients and modern equipment.',
                reasonForSelling: 'Owner retiring after successful 9-year operation. Well-established business with strong customer loyalty and consistent profitability.',
                keyHighlights: [
                    '8-bay service facility with modern equipment',
                    'Loyal customer base (500+ active clients)',
                    'Prime Plano location with high visibility',
                    'Established vendor relationships and contracts',
                    'Trained technician team with low turnover',
                    'Strong reputation in local community'
                ],

                // Assets & Equipment
                assetsIncluded: [
                    'Complete diagnostic equipment suite',
                    '8 hydraulic lifts and service bays',
                    'Air compressor and pneumatic tools',
                    'Tire mounting and balancing equipment',
                    'Parts inventory (estimated $45,000 value)',
                    'Office furniture and computer systems',
                    'Customer database and management software'
                ],

                // Customer Base
                customerBase: {
                    totalActiveCustomers: 500,
                    averageTicket: '$285',
                    repeatCustomerRate: '78%',
                    customerAcquisitionCost: '$45',
                    demographics: 'Mix of individual consumers and small fleet accounts'
                },

                // Historical Financial Data
                historicalRevenue: [
                    { year: 2020, revenue: 580000 },
                    { year: 2021, revenue: 650000 },
                    { year: 2022, revenue: 720000 },
                    { year: 2023, revenue: 750000 },
                    { year: 2024, revenue: 775000 }
                ],

                historicalProfit: [
                    { year: 2020, profit: 145000 },
                    { year: 2021, profit: 162000 },
                    { year: 2022, profit: 175000 },
                    { year: 2023, profit: 185000 },
                    { year: 2024, profit: 195000 }
                ],

                monthlyTrends: [
                    { month: 'Jan', revenue: 58000 },
                    { month: 'Feb', revenue: 62000 },
                    { month: 'Mar', revenue: 68000 },
                    { month: 'Apr', revenue: 65000 },
                    { month: 'May', revenue: 72000 },
                    { month: 'Jun', revenue: 75000 },
                    { month: 'Jul', revenue: 78000 },
                    { month: 'Aug', revenue: 74000 },
                    { month: 'Sep', revenue: 69000 },
                    { month: 'Oct', revenue: 71000 },
                    { month: 'Nov', revenue: 66000 },
                    { month: 'Dec', revenue: 63000 }
                ],

                expenseBreakdown: [
                    { category: 'Labor', amount: 285000, percentage: 38 },
                    { category: 'Parts & Materials', amount: 180000, percentage: 24 },
                    { category: 'Rent & Utilities', amount: 72000, percentage: 10 },
                    { category: 'Insurance', amount: 36000, percentage: 5 },
                    { category: 'Equipment & Maintenance', amount: 27000, percentage: 4 },
                    { category: 'Marketing', amount: 18000, percentage: 2 },
                    { category: 'Other Operating', amount: 127000, percentage: 17 }
                ],

                // Property Details
                propertyInfo: {
                    ownershipStatus: 'lease',
                    squareFootage: '6,500 sq ft',
                    serviceArea: '5,200 sq ft',
                    officeSpace: '800 sq ft',
                    storageArea: '500 sq ft',
                    parkingSpaces: 15,

                    // Lease Information (for leased properties)
                    monthlyLeaseAmount: '$8,500',
                    leaseDuration: '7 years remaining',
                    leaseType: 'Triple Net Lease',
                    leaseTerms: 'Transferable 10-year lease with renewal options, 3% annual escalation',
                    transferability: 'Fully transferable to qualified buyer',
                    securityDeposit: '$25,500',
                    leaseExpiration: '2031-12-31'
                },

                // Images
                images: [
                    'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80',
                    'https://images.unsplash.com/photo-1486754735734-325b5831c3ad?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80'
                ]
            },
            'family-auto-repair': {
                // Basic Information
                displayName: 'Family-Owned Service Center',
                location: 'Frisco, TX',
                businessType: 'Auto Repair & Service',
                businessStructure: 'S-Corporation',
                yearEstablished: 2008,
                employees: 6,

                // Financial Information
                askingPrice: '$325,000',
                annualRevenue: '$520,000',
                netProfit: '$145,000',
                grossMargin: '62%',

                // Business Overview
                description: 'Well-established family-owned auto repair shop in growing Frisco market. Strong community reputation and consistent customer base built over 16 years.',
                reasonForSelling: 'Family relocating out of state. Excellent opportunity for new owner to continue successful operation with established customer relationships.',
                keyHighlights: [
                    '6-bay service center with quality equipment',
                    'Strong community reputation and trust',
                    'Growing Frisco market with expanding population',
                    'Established customer relationships spanning decades',
                    'Consistent revenue stream with seasonal stability',
                    'Experienced staff willing to stay with new ownership'
                ],

                // Assets & Equipment
                assetsIncluded: [
                    'Complete automotive diagnostic systems',
                    '6 hydraulic lifts in excellent condition',
                    'Comprehensive tool inventory',
                    'Tire service equipment and balancer',
                    'Parts inventory (estimated $28,000 value)',
                    'Customer management software and records',
                    'Office equipment and furniture'
                ],

                // Customer Base
                customerBase: {
                    totalActiveCustomers: 380,
                    averageTicket: '$245',
                    repeatCustomerRate: '85%',
                    customerAcquisitionCost: '$35',
                    demographics: 'Primarily local families and long-term residents'
                },

                // Historical Financial Data
                historicalRevenue: [
                    { year: 2020, revenue: 445000 },
                    { year: 2021, revenue: 475000 },
                    { year: 2022, revenue: 495000 },
                    { year: 2023, revenue: 520000 },
                    { year: 2024, revenue: 535000 }
                ],

                historicalProfit: [
                    { year: 2020, profit: 125000 },
                    { year: 2021, profit: 135000 },
                    { year: 2022, profit: 140000 },
                    { year: 2023, profit: 145000 },
                    { year: 2024, profit: 152000 }
                ],

                monthlyTrends: [
                    { month: 'Jan', revenue: 41000 },
                    { month: 'Feb', revenue: 43000 },
                    { month: 'Mar', revenue: 47000 },
                    { month: 'Apr', revenue: 45000 },
                    { month: 'May', revenue: 48000 },
                    { month: 'Jun', revenue: 46000 },
                    { month: 'Jul', revenue: 44000 },
                    { month: 'Aug', revenue: 42000 },
                    { month: 'Sep', revenue: 45000 },
                    { month: 'Oct', revenue: 47000 },
                    { month: 'Nov', revenue: 44000 },
                    { month: 'Dec', revenue: 43000 }
                ],

                expenseBreakdown: [
                    { category: 'Labor', amount: 195000, percentage: 37 },
                    { category: 'Parts & Materials', amount: 130000, percentage: 25 },
                    { category: 'Rent & Utilities', amount: 48000, percentage: 9 },
                    { category: 'Insurance', amount: 26000, percentage: 5 },
                    { category: 'Equipment & Maintenance', amount: 18000, percentage: 3 },
                    { category: 'Marketing', amount: 12000, percentage: 2 },
                    { category: 'Other Operating', amount: 91000, percentage: 19 }
                ],

                // Property Details
                propertyInfo: {
                    ownershipStatus: 'owned',
                    squareFootage: '4,800 sq ft',
                    serviceArea: '3,800 sq ft',
                    officeSpace: '600 sq ft',
                    storageArea: '400 sq ft',
                    parkingSpaces: 12,

                    // Ownership Information (for owned properties)
                    purchasePrice: '$650,000',
                    propertyTaxes: '$12,800',
                    propertyInsurance: '$4,200',
                    mortgageDetails: {
                        downPaymentPercent: 20,
                        loanTermYears: 20,
                        interestRate: 8.0,
                        // Calculated values will be computed dynamically
                        downPayment: '$130,000',
                        loanAmount: '$520,000',
                        monthlyPayment: '$4,344',
                        totalInterest: '$522,560'
                    }
                },

                // Images
                images: [
                    'https://images.unsplash.com/photo-1486754735734-325b5831c3ad?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80',
                    'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80'
                ]
            },
            'express-auto-care': {
                // Basic Information
                displayName: 'Express Service Center',
                location: 'Allen, TX',
                businessType: 'Quick Service Auto Care',
                businessStructure: 'LLC',
                yearEstablished: 2012,
                employees: 5,

                // Financial Information
                askingPrice: '$275,000',
                annualRevenue: '$420,000',
                netProfit: '$125,000',
                grossMargin: '58%',

                // Business Overview
                description: 'Modern express auto care facility specializing in quick service. High-traffic location with excellent visibility and significant growth potential.',
                reasonForSelling: 'Owner expanding to multiple locations and seeking partner for this profitable operation. Excellent growth opportunity for hands-on operator.',
                keyHighlights: [
                    'Express service model with quick turnaround',
                    'Modern equipment and efficient workflow',
                    'High-traffic location with excellent visibility',
                    'Strong growth potential in expanding market',
                    'Streamlined operations and proven systems',
                    'Loyal customer base with repeat business'
                ],

                // Assets & Equipment
                assetsIncluded: [
                    'State-of-the-art quick service equipment',
                    '4 service bays optimized for efficiency',
                    'Express oil change system',
                    'Quick tire service equipment',
                    'Point-of-sale and scheduling systems',
                    'Parts inventory (estimated $22,000 value)',
                    'Customer database and loyalty program'
                ],

                // Customer Base
                customerBase: {
                    totalActiveCustomers: 320,
                    averageTicket: '$185',
                    repeatCustomerRate: '72%',
                    customerAcquisitionCost: '$28',
                    demographics: 'Busy professionals and families seeking quick service'
                },

                // Historical Financial Data
                historicalRevenue: [
                    { year: 2020, revenue: 325000 },
                    { year: 2021, revenue: 365000 },
                    { year: 2022, revenue: 390000 },
                    { year: 2023, revenue: 420000 },
                    { year: 2024, revenue: 445000 }
                ],

                historicalProfit: [
                    { year: 2020, profit: 95000 },
                    { year: 2021, profit: 108000 },
                    { year: 2022, profit: 118000 },
                    { year: 2023, profit: 125000 },
                    { year: 2024, profit: 135000 }
                ],

                monthlyTrends: [
                    { month: 'Jan', revenue: 32000 },
                    { month: 'Feb', revenue: 34000 },
                    { month: 'Mar', revenue: 38000 },
                    { month: 'Apr', revenue: 36000 },
                    { month: 'May', revenue: 39000 },
                    { month: 'Jun', revenue: 37000 },
                    { month: 'Jul', revenue: 35000 },
                    { month: 'Aug', revenue: 33000 },
                    { month: 'Sep', revenue: 36000 },
                    { month: 'Oct', revenue: 38000 },
                    { month: 'Nov', revenue: 35000 },
                    { month: 'Dec', revenue: 34000 }
                ],

                expenseBreakdown: [
                    { category: 'Labor', amount: 147000, percentage: 35 },
                    { category: 'Parts & Materials', amount: 105000, percentage: 25 },
                    { category: 'Rent & Utilities', amount: 42000, percentage: 10 },
                    { category: 'Insurance', amount: 21000, percentage: 5 },
                    { category: 'Equipment & Maintenance', amount: 16800, percentage: 4 },
                    { category: 'Marketing', amount: 12600, percentage: 3 },
                    { category: 'Other Operating', amount: 75600, percentage: 18 }
                ],

                // Property Details
                propertyInfo: {
                    ownershipStatus: 'lease',
                    squareFootage: '3,200 sq ft',
                    serviceArea: '2,400 sq ft',
                    officeSpace: '400 sq ft',
                    storageArea: '400 sq ft',
                    parkingSpaces: 10,

                    // Lease Information (for leased properties)
                    monthlyLeaseAmount: '$6,200',
                    leaseDuration: '5 years remaining',
                    leaseType: 'Modified Gross Lease',
                    leaseTerms: 'Transferable 7-year lease with expansion options, 2.5% annual escalation',
                    transferability: 'Transferable with landlord approval',
                    securityDeposit: '$18,600',
                    leaseExpiration: '2029-08-31'
                },

                // Images
                images: [
                    'https://images.unsplash.com/photo-1619642751034-765dfdf7c58e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1374&q=80',
                    'https://images.unsplash.com/photo-1486754735734-325b5831c3ad?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80'
                ]
            }
        };

        // Note: handleBusinessDetailsClick is already defined above with proper error handling

        // Open business details modal
        function openBusinessDetailsModal(businessId) {
            console.log('Opening modal for business:', businessId);
            const business = featuredBusinesses[businessId];
            if (!business) {
                console.error('Business not found:', businessId);
                alert('Business details not found. Please try again.');
                return;
            }

            // Populate modal content
            const modalContent = document.getElementById('modal-content');
            const modalTitle = document.getElementById('modal-title');

            modalTitle.textContent = business.displayName || business.name;

            modalContent.innerHTML = `
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Business Image -->
                    <div class="space-y-6">
                        <div class="relative">
                            <img src="${business.images ? business.images[0] : business.image}" alt="${business.displayName || business.name}" class="w-full h-64 object-cover rounded-xl">
                            <div class="absolute top-4 right-4 bg-emerald-500 text-white text-sm font-bold px-3 py-2 rounded-full">
                                Express Deal
                            </div>
                        </div>

                        <!-- Key Features -->
                        <div>
                            <h3 class="text-lg font-semibold text-slate-900 dark:text-white mb-4">Key Highlights</h3>
                            <div class="space-y-2">
                                ${(business.keyHighlights || business.features || []).slice(0, 6).map(feature => `
                                    <div class="flex items-center text-slate-700 dark:text-slate-300">
                                        <svg class="w-4 h-4 text-emerald-500 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                        </svg>
                                        ${feature}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>

                    <!-- Business Details -->
                    <div class="space-y-6">
                        <!-- Basic Info -->
                        <div>
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h3 class="text-xl font-bold text-slate-900 dark:text-white">${business.displayName || business.name}</h3>
                                    <p class="text-slate-600 dark:text-slate-400">${business.location}</p>
                                    <p class="text-sm text-slate-500 dark:text-slate-400">${business.businessType || 'Auto Repair & Service'}</p>
                                </div>
                                <div class="text-right">
                                    <div class="text-3xl font-bold text-emerald-600 dark:text-emerald-400">${business.askingPrice || business.price}</div>
                                    <div class="text-sm text-slate-500 dark:text-slate-400">Asking Price</div>
                                </div>
                            </div>
                            <p class="text-slate-700 dark:text-slate-300 leading-relaxed">${business.description}</p>
                        </div>

                        <!-- Financial Metrics -->
                        <div>
                            <h3 class="text-lg font-semibold text-slate-900 dark:text-white mb-4">Financial Overview</h3>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="bg-slate-50 dark:bg-slate-800 rounded-lg p-4">
                                    <div class="text-slate-600 dark:text-slate-400 text-sm">Annual Revenue</div>
                                    <div class="text-xl font-bold text-slate-900 dark:text-white">${business.annualRevenue || business.financials?.annualRevenue || business.revenue}</div>
                                </div>
                                <div class="bg-slate-50 dark:bg-slate-800 rounded-lg p-4">
                                    <div class="text-slate-600 dark:text-slate-400 text-sm">Net Profit</div>
                                    <div class="text-xl font-bold text-slate-900 dark:text-white">${business.netProfit || business.financials?.cashFlow}</div>
                                </div>
                                <div class="bg-slate-50 dark:bg-slate-800 rounded-lg p-4">
                                    <div class="text-slate-600 dark:text-slate-400 text-sm">Gross Margin</div>
                                    <div class="text-xl font-bold text-emerald-600 dark:text-emerald-400">${business.grossMargin || business.financials?.roi}</div>
                                </div>
                                <div class="bg-slate-50 dark:bg-slate-800 rounded-lg p-4">
                                    <div class="text-slate-600 dark:text-slate-400 text-sm">Established</div>
                                    <div class="text-xl font-bold text-slate-900 dark:text-white">${business.yearEstablished || business.established}</div>
                                </div>
                            </div>
                        </div>

                        <!-- Additional Details -->
                        <div>
                            <h3 class="text-lg font-semibold text-slate-900 dark:text-white mb-4">Business Details</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-slate-600 dark:text-slate-400">Employees:</span>
                                    <span class="text-slate-900 dark:text-white font-medium">${business.employees || business.financials?.employees}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-slate-600 dark:text-slate-400">Business Structure:</span>
                                    <span class="text-slate-900 dark:text-white font-medium">${business.businessStructure || 'LLC'}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-slate-600 dark:text-slate-400">Square Footage:</span>
                                    <span class="text-slate-900 dark:text-white font-medium">${business.propertyInfo?.squareFootage || business.financials?.squareFootage}</span>
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="space-y-4 pt-4">
                            <!-- Primary Action: Full Details -->
                            <button type="button" onclick="openFullDetailsPage('${businessId}')" class="w-full bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 text-white font-bold py-4 px-6 rounded-full transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105">
                                <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v4a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                </svg>
                                Full Details & Analysis
                            </button>

                            <!-- Secondary Actions -->
                            <div class="flex flex-col sm:flex-row gap-3">
                                <button type="button" class="flex-1 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold py-3 px-6 rounded-full transition-all duration-200 shadow-lg hover:shadow-xl">
                                    Schedule Viewing
                                </button>
                                <button type="button" class="flex-1 border-2 border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800 font-semibold py-3 px-6 rounded-full transition-all duration-200">
                                    Contact Seller
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Show modal
            const modal = document.getElementById('business-details-modal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            document.body.style.overflow = 'hidden';

            // Focus management for accessibility
            const closeButton = document.getElementById('close-modal');
            closeButton.focus();
        }

        // Close modal function
        function closeBusinessDetailsModal() {
            console.log('🔒 Closing business details modal...');

            const modal = document.getElementById('business-details-modal');
            if (!modal) {
                console.error('❌ Modal element not found');
                return;
            }

            // Hide modal
            modal.classList.add('hidden');
            modal.classList.remove('flex');

            // Restore body scroll
            document.body.style.overflow = '';

            // Clear modal content to prevent stale data
            const modalContent = document.getElementById('modal-content');
            if (modalContent) {
                modalContent.innerHTML = '';
            }

            console.log('✅ Modal closed successfully');
        }

        // Initialize modal event listeners immediately (not waiting for DOMContentLoaded)
        function initializeModalEventListeners() {
            console.log('🔧 Initializing modal event listeners...');

            // Close button
            const closeButton = document.getElementById('close-modal');
            if (closeButton) {
                closeButton.addEventListener('click', closeBusinessDetailsModal);
                console.log('✅ Close button event listener attached');
            } else {
                console.warn('⚠️ Close button not found');
            }

            // Close on backdrop click
            const modal = document.getElementById('business-details-modal');
            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        console.log('🖱️ Backdrop clicked, closing modal');
                        closeBusinessDetailsModal();
                    }
                });
                console.log('✅ Backdrop click event listener attached');
            } else {
                console.warn('⚠️ Modal element not found');
            }

            // Close on Escape key (only attach once globally)
            if (!window.featuredListingsEscapeListenerAttached) {
                document.addEventListener('keydown', function(e) {
                    if (e.key === 'Escape') {
                        const modal = document.getElementById('business-details-modal');
                        if (modal && !modal.classList.contains('hidden')) {
                            console.log('⌨️ Escape key pressed, closing modal');
                            closeBusinessDetailsModal();
                        }
                    }
                });
                window.featuredListingsEscapeListenerAttached = true;
                console.log('✅ Escape key event listener attached');
            }
        }

        // Initialize event listeners immediately
        initializeModalEventListeners();

        // Navigate to full details page from modal
        function openFullDetailsPage(businessId) {
            console.log('Opening full details page for:', businessId);
            try {
                // Store business data in sessionStorage for the details page
                const business = featuredBusinesses[businessId];
                if (business) {
                    sessionStorage.setItem('selectedBusiness', JSON.stringify({
                        id: businessId,
                        data: business
                    }));

                    // Navigate to business details page
                    window.location.href = `business-details.html?id=${businessId}`;
                } else {
                    console.error('Business not found:', businessId);
                    alert('Business details not found. Please try again.');
                }
            } catch (error) {
                console.error('Error navigating to full details:', error);
                alert('Sorry, there was an error loading the full details. Please try again.');
            }
        }

        // Make functions and data globally available
        window.openBusinessDetailsModal = openBusinessDetailsModal;
        window.closeBusinessDetailsModal = closeBusinessDetailsModal;
        window.openFullDetailsPage = openFullDetailsPage;
        window.featuredBusinesses = featuredBusinesses;
        // handleBusinessDetailsClick already defined globally above

        console.log('✅ Featured businesses data exposed globally:', Object.keys(featuredBusinesses));

        // Debug: Log when functions are available
        console.log('Featured Listings functions loaded:', {
            openBusinessDetailsModal: typeof window.openBusinessDetailsModal,
            closeBusinessDetailsModal: typeof window.closeBusinessDetailsModal,
            handleBusinessDetailsClick: typeof window.handleBusinessDetailsClick
        });

        // Force immediate availability check
        setTimeout(() => {
            console.log('Post-load function check:', {
                openBusinessDetailsModal: typeof window.openBusinessDetailsModal,
                closeBusinessDetailsModal: typeof window.closeBusinessDetailsModal,
                handleBusinessDetailsClick: typeof window.handleBusinessDetailsClick
            });
        }, 100);
    </script>
</section>
